<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bhagyam tiwari - Portfolio</title>
    
    <!-- Load Inter Font from Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <style>
        /* Base Styles: Clean, Light Theme */
        :root {
            --bg-color: #ffffff;
            --text-color: #1a1a1a; /* Dark text */
            --link-color: #007bff; /* Primary blue for links */
            --accent-color: #4CAF50; /* Green accent */
            --border-color: #dddddd;
            --box-bg: #f8f8f8; /* Very light grey box background */
        }

        body {
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Inter', sans-serif; 
            font-size: 14px;
            line-height: 1.6;
            overflow: hidden; 
            cursor: default; 
            position: relative;
            display: flex;
            flex-wrap: wrap; /* Allows wrapping on desktop if needed, but flex-start is controlled by JS positioning */
            justify-content: flex-start;
            align-items: flex-start;
            text-transform: lowercase; 
            user-select: none;
        }

        /* --- BLUR EFFECT & OVERLAY STYLES --- */
        .blurred-content {
            filter: blur(5px);
            transition: filter 0.8s ease-in-out;
            pointer-events: none; /* Disable interaction when blurred */
        }
        
        #auth-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(255, 255, 255, 0.95); 
            z-index: 1000; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: 'Inter', sans-serif;
            text-transform: lowercase;
            transition: opacity 0.8s ease-in-out;
        }

        #auth-box {
            padding: 30px;
            background: var(--box-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            text-align: center;
            min-width: 280px;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
            border-color: red !important;
        }

        #password-input {
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            margin: 15px 0;
            font-size: 1.1em;
            width: 80%; /* Responsive width */
            max-width: 250px;
            text-align: center;
            text-transform: none; 
        }
        #unlock-btn {
            padding: 10px 20px;
            background: var(--link-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 700;
            transition: background 0.2s;
        }
        #unlock-btn:hover {
            background: var(--accent-color);
        }
        
        /* --- DESKTOP/DRAGGABLE BOX STYLES (Default for >768px) --- */
        .draggable-box {
            position: absolute;
            z-index: 10; 
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--box-bg); 
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); 
            transition: opacity 0.3s, box-shadow 0.2s, border-color 0.2s, transform 0s;
            cursor: grab;
            min-width: 150px;
            min-height: 100px;
            overflow: hidden; 
        }

        .box-handle {
            font-weight: 600; display: flex; justify-content: space-between; align-items: center; 
            border-bottom: 1px solid var(--border-color);
            margin: -15px -15px 10px -15px;
            padding: 8px 15px; 
            color: var(--link-color); 
            font-size: 0.75em; 
            text-transform: uppercase;
            cursor: grab;
        }
        
        .box-content {
            height: calc(100% - 30px);
            overflow: auto;
            padding-right: 5px; 
        }
        
        .resize-handle { display: block; } /* Visible on desktop */
        
        /* Dino Box Specifics */
        .dino-box { padding: 0; background: black;}
        .dino-box .box-content { height: calc(100% - 35px); padding: 0;}
        .dino-box .box-handle { margin: 0; height: 35px; background-color: var(--box-bg); border-radius: 8px 8px 0 0;}

        /* --- MOBILE OVERRIDES (For screens <= 768px) --- */
        @media (max-width: 768px) {
            body {
                padding: 10px;
                overflow-y: auto; /* Enable scrolling on mobile */
                overflow-x: hidden;
                display: block; /* Switch to block flow */
            }
            
            .draggable-box {
                position: static !important; /* Disable absolute positioning */
                width: 100% !important; /* Full width */
                min-width: unset !important;
                max-width: unset !important;
                height: auto !important; /* Auto height for stacking */
                min-height: unset !important;
                margin-bottom: 15px; /* Space between stacked boxes */
                left: unset !important;
                top: unset !important;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
                cursor: default !important;
            }
            
            .resize-handle, #maximize-dino {
                display: none !important; /* Hide resize handles and maximize button */
            }
            
            .box-handle {
                cursor: default !important;
                margin: -15px -15px 10px -15px; /* Restore standard margins */
            }
            
            .box-content {
                height: auto !important;
                overflow: visible !important;
                padding-right: 0;
            }

            /* Fix embedded content heights on mobile */
            .dino-box {
                height: 300px !important; /* Fixed height for embedded game */
            }
            .dino-box .box-content {
                height: 100% !important;
            }
        }
        
        /* Other component styles (Calculator, Clocks, etc.) */
        #calculator-ui {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            padding: 5px;
            max-width: 250px;
        }
        #calc-display {
            grid-column: span 4;
            background: #fff;
            border: 1px solid var(--border-color);
            padding: 10px;
            text-align: right;
            font-size: 1.5em;
            margin-bottom: 5px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .calc-btn {
            padding: 15px 10px;
            background: #e0e0e0;
            border: none;
            border-radius: 4px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background 0.1s;
        }
        .calc-op { background: #b0d8ff; }
        .calc-eq { background: var(--accent-color); color: white; grid-column: span 2; }
        .calc-clear { background: #ffaaaa; }

        .clock-list, .streaming-links { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 6px; }
        .clock-item { font-size: 1.05em; font-weight: 400; padding: 4px 0; border-bottom: 1px dashed #eee; }
        .streaming-links a { padding: 8px; background: var(--link-color); color: white; border-radius: 4px; text-align: center; font-weight: 600; }
        .timer-display { font-size: 2.5em; font-weight: 700; text-align: center; margin-bottom: 10px; color: var(--link-color); }
        .timer-controls { display: flex; gap: 10px; justify-content: center; margin-bottom: 10px; }
        .timer-controls button { padding: 8px 15px; border-radius: 4px; border: none; cursor: pointer; font-weight: 600; }

    </style>
</head>
<body class="blurred-content">
    <!-- Load Tailwind and Icons -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <!-- --- AUTHENTICATION OVERLAY --- -->
    <div id="auth-overlay">
        <div id="auth-box">
            <h2 style="font-size: 1.5em; margin-bottom: 5px; color: var(--text-color);">access restricted</h2>
            <p style="color: #666; margin-bottom: 10px;">enter the secret phrase to unlock the desktop, or wait 30 seconds for automatic access.</p>
            <input type="password" id="password-input" placeholder="secret phrase">
            <button id="unlock-btn" onclick="checkPassword()">unlock desktop</button>
            <p id="auth-message" style="color: red; margin-top: 10px; font-size: 0.9em;"></p>
        </div>
    </div>
    
    <!-- --- MAIN CONTENT CONTAINER --- -->
    <div class="draggable-box" id="main-container" style="width: 450px; height: 350px; top: 50px; left: 50px;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <div class="box-handle"><span>/bhagyam_tiwari/profile.txt</span></div>
        
        <div class="box-content">
            <h1 id="main-title" style="font-size: 2.2em; margin: 0 0 10px 0; color: var(--text-color); font-weight: 700;">bhagyam tiwari</h1>
            
            <div class="social-icons">
                <a href="https://twitter.com/maygahb" target="_blank" title="x: @maygahb">
                    <i class="fa-brands fa-x-twitter"></i>
                </a>
                <a href="https://instagram.com/bhagyamtiwari" target="_blank" title="instagram: @bhagyamtiwari">
                    <i class="fa-brands fa-instagram"></i>
                </a>
                <a href="mailto:btiwarinine@gmail.com" title="email: btiwarinine@gmail.com">
                    <i class="fa-solid fa-envelope"></i>
                </a>
            </div>
            
            <div class="statement" style="font-size: 1.1em; font-style: italic; margin-bottom: 15px;">i don't code for a living.</div>

            <span class="bio-intro" style="font-size: 0.9em; color: #666;">linkedin bio from 2024 that i couldn't be bothered to change:</span>
            <p class="bio-paragraph" style="font-size: 1em; margin-top: 5px;">finance major pursuing a bba at the zicklin school of business, baruch college, city university of new york. raised in belarus, turkey, pakistan, india, and the united states, with an internationally peripatetic upbringing and diverse educational experiences. internship experiences in the financial services industry and municipal bond markets. concurrently building an early-stage startup based in new delhi, india.</p>
        </div>
    </div>
    
    <!-- --- DRAGGABLE BOXES --- -->

    <!-- 1. Calculator Box -->
    <div class="draggable-box" style="width: 280px; height: 350px; top: 430px; left: 50px;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <div class="box-handle"><span>/applications/calc.exe</span></div>
        <div class="box-content">
            <div id="calculator-ui">
                <div id="calc-display">0</div>
                <button class="calc-btn calc-clear" onclick="clearDisplay()">AC</button>
                <button class="calc-btn calc-op" onclick="appendOperator('%')">%</button>
                <button class="calc-btn calc-op" onclick="appendOperator('/')">÷</button>
                <button class="calc-btn calc-op" onclick="appendOperator('*')">×</button>
                
                <button class="calc-btn" onclick="appendNumber('7')">7</button>
                <button class="calc-btn" onclick="appendNumber('8')">8</button>
                <button class="calc-btn" onclick="appendNumber('9')">9</button>
                <button class="calc-btn calc-op" onclick="appendOperator('-')">-</button>
                
                <button class="calc-btn" onclick="appendNumber('4')">4</button>
                <button class="calc-btn" onclick="appendNumber('5')">5</button>
                <button class="calc-btn" onclick="appendNumber('6')">6</button>
                <button class="calc-btn calc-op" onclick="appendOperator('+')">+</button>
                
                <button class="calc-btn" onclick="appendNumber('1')">1</button>
                <button class="calc-btn" onclick="appendNumber('2')">2</button>
                <button class="calc-btn" onclick="appendNumber('3')">3</button>
                
                <button class="calc-btn" onclick="appendNumber('0')">0</button>
                <button class="calc-btn" onclick="appendDecimal()">.</button>
                <button class="calc-btn calc-eq" onclick="calculateResult()">=</button>
            </div>
        </div>
    </div>
    
    <!-- 2. Clocks Box -->
    <div class="draggable-box" style="width: 300px; height: 280px; top: 50px; left: 550px;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <div class="box-handle"><span>/time_temp/global_time.dat</span></div>
        <div class="box-content">
            <h3 style="margin: 0 0 10px 0; font-size: 1.2em; font-weight: 600;">global time status</h3>
            <ul class="clock-list" id="clock-container">
                <li class="clock-item" id="delhi-time">loading delhi...</li>
                <li class="clock-item" id="mumbai-time">loading mumbai...</li>
                <li class="clock-item" id="bangalore-time">loading bangalore...</li>
                <li class="clock-item" id="dubai-time">loading dubai...</li>
                <li class="clock-item" id="newyork-time">loading new york...</li>
                <li class="clock-item" id="london-time">loading london...</li>
            </ul>
        </div>
    </div>

    <!-- 3. Timer Box -->
    <div class="draggable-box" style="width: 250px; height: 280px; top: 350px; left: 580px;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <div class="box-handle"><span>/applications/timer.app</span></div>
        <div class="box-content">
            <h3 style="margin: 0 0 10px 0; font-size: 1.2em; font-weight: 600;">countdown timer</h3>
            <div class="timer-display" id="timer-display">00:00</div>
            <div class="timer-input-group">
                <input type="number" id="minutes-input" value="1" min="0" max="59" placeholder="min">
                <input type="number" id="seconds-input" value="0" min="0" max="59" placeholder="sec">
            </div>
            <div class="timer-controls">
                <button style="background: var(--accent-color); color: white;" onclick="startTimer()">start</button>
                <button style="background: #ffcc00; color: var(--text-color);" onclick="pauseTimer()">pause</button>
                <button style="background: #ffaaaa; color: var(--text-color);" onclick="resetTimer()">reset</button>
            </div>
            <p id="timer-status" style="text-align: center; font-size: 0.9em; color: var(--link-color); margin-top: 10px;">set duration and click start.</p>
        </div>
    </div>


    <!-- 4. Dino Game Box -->
    <div class="draggable-box dino-box" id="dino-box" style="width: 500px; height: 350px; top: 700px; left: 50px;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <div class="box-handle">
            <span>/games/dino_runner.exe</span>
            <button class="action-btn" id="maximize-dino">[MAXIMIZE]</button>
        </div>
        <div class="box-content">
            <iframe id="dino-iframe" src="https://chromedino.com/" title="Chrome Dino Game" frameborder="0" scrolling="no" loading="lazy"></iframe>
        </div>
    </div>

    <!-- 5. Sudoku Embed Box -->
    <div class="draggable-box" style="width: 750px; height: 700px; top: 50px; left: 900px; padding: 0;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <div class="box-handle" style="margin: 0; border-radius: 8px 8px 0 0;"><span>/games/daily_sudoku.web</span></div>
        <div class="box-content" style="height: calc(100% - 35px); padding: 0;">
            <iframe src="https://sudoku.com/embed/daily/?theme=light" title="Daily Sudoku" frameborder="0" scrolling="no" allowfullscreen></iframe>
        </div>
    </div>
    
    <!-- 6. Streaming Links Box -->
    <div class="draggable-box" style="width: 250px; height: 280px; top: 700px; left: 850px;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <div class="box-handle"><span>/links/streaming.url</span></div>
        <div class="box-content">
            <h3 style="margin: 0 0 10px 0; font-size: 1.2em; font-weight: 600;">streaming services</h3>
            <div class="streaming-links">
                <a href="https://www.netflix.com/" target="_blank">netflix</a>
                <a href="https://www.hotstar.com/in" target="_blank">jiohotstar</a>
                <a href="https://www.primevideo.com/" target="_blank">amazon prime video</a>
                <a href="https://www.sonyliv.com/" target="_blank">sonyliv</a>
            </div>
        </div>
    </div>
    
    <!-- 7. Fact of the Day Box -->
    <div class="draggable-box" style="width: 350px; height: 150px; top: 800px; left: 450px;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <div class="box-handle"><span>/info/fact_of_day.txt</span></div>
        <div class="box-content">
            <div class="flex items-center mb-2">
                <i class="material-icons text-xl mr-2 text-red-500">lightbulb_outline</i>
                <h3 style="margin: 0; font-size: 1.2em; font-weight: 600;">fact of the day</h3>
            </div>
            <p id="daily-fact" style="font-size: 1em; margin: 0;">
                the earth's rotation is slowing down at a rate of approximately 1.8 milliseconds per century, which means that in millions of years, a day will be significantly longer.
            </p>
        </div>
    </div>
    
    <!-- 8. NYT Wordle Link Box -->
    <div class="draggable-box" style="width: 250px; height: 100px; top: 800px; left: 1200px;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <span class="box-handle">nyt_wordle.url</span>
        <div class="box-content">
            <h3 style="margin: 0 0 5px 0; font-size: 1.2em; font-weight: 600;">nyt wordle</h3>
            <p style="margin: 0; line-height: 1.3;">
                <a href="https://www.nytimes.com/games/wordle/index.html" target="_blank" style="font-size: 1.1em; font-weight: 600;">click here to play</a>
            </p>
        </div>
    </div>

    <!-- 9. WSOP Link Box -->
    <div class="draggable-box" style="width: 250px; height: 100px; top: 800px; left: 1480px;">
        <div class="resize-handle top-left" data-direction="tl"></div>
        <div class="resize-handle top-right" data-direction="tr"></div>
        <div class="resize-handle bottom-left" data-direction="bl"></div>
        <div class="resize-handle bottom-right" data-direction="br"></div>
        <span class="box-handle">wsop.url</span>
        <div class="box-content">
            <h3 style="margin: 0 0 5px 0; font-size: 1.2em; font-weight: 600;">wsop (poker)</h3>
            <p style="margin: 0; line-height: 1.3;">
                <a href="https://www.playwsop.com/play" target="_blank" style="font-size: 1.1em; font-weight: 600;">click here to play wsop</a>
            </p>
        </div>
    </div>


    <script>
        // === AUTHENTICATION LOGIC ===
        const CORRECT_PASSWORD = 'bhagyamisawesome';
        const UNLOCK_TIMEOUT_MS = 30000; // 30 seconds
        let unlockTimeoutId = null;

        /**
         * Performs the actual desktop unlock sequence.
         */
        function performUnlock() {
            // Only proceed if the blur is active
            const body = document.body;
            if (!body.classList.contains('blurred-content')) return;

            const overlay = document.getElementById('auth-overlay');
            
            // 1. Crucially clear the timeout if it was set
            if (unlockTimeoutId) {
                clearTimeout(unlockTimeoutId);
                unlockTimeoutId = null;
            }
            
            // 2. Remove blur immediately
            body.classList.remove('blurred-content'); 
            
            // 3. Fade out the overlay
            overlay.style.opacity = '0';
            
            // 4. Clean up the overlay and start desktop functions after fade
            setTimeout(() => {
                overlay.remove();
                // Re-enable pointer events for the body content
                body.style.pointerEvents = 'auto'; 
                // Set initial Z-index and start clocks once unlocked
                setInitialZIndex();
                updateClocks();
                setInterval(updateClocks, 1000);
            }, 800); 
        }

        /**
         * Triggered if the password is correct.
         */
        function checkPassword() {
            const input = document.getElementById('password-input').value.toLowerCase().trim();
            const message = document.getElementById('auth-message');
            const authBox = document.getElementById('auth-box');

            // Reset error state
            message.textContent = '';
            authBox.classList.remove('shake');

            if (input === CORRECT_PASSWORD) {
                message.textContent = 'access granted.';
                performUnlock();
            } else {
                // Incorrect password: Show error and shake box
                message.textContent = 'incorrect secret phrase. try again.';
                authBox.classList.add('shake');
                document.getElementById('password-input').value = ''; // Clear input
            }
        }

        /**
         * Triggered by the 30-second timeout.
         */
        function autoUnlock() {
            const message = document.getElementById('auth-message');
            message.textContent = 'unlocked automatically...';
            performUnlock();
        }

        // ===================================
        // === DESKTOP INITIALIZATION & DRAG/RESIZE LOGIC ===
        // ===================================

        const MIN_SIZE = 150; 
        const MIN_Z_INDEX = 10; 
        let currentMaxZ = MIN_Z_INDEX; 

        const draggableBoxes = document.querySelectorAll('.draggable-box');
        const resizeHandles = document.querySelectorAll('.resize-handle');
        const dinoBox = document.getElementById('dino-box');
        const maximizeDinoButton = document.getElementById('maximize-dino');
        
        let activeDraggableBox = null;
        let dragOffsetX, dragOffsetY;
        let isResizing = false;
        let activeBox = null;
        let activeHandle = null;
        let startX, startY, initialW, initialH, initialL, initialT;
        let isDinoMaximized = false;
        let dinoRestoreState = {};
        
        // Check if desktop features should be enabled (i.e., not mobile)
        const isDesktopView = () => window.innerWidth > 768;


        function setInitialZIndex() {
             draggableBoxes.forEach((box) => {
                currentMaxZ++;
                box.style.zIndex = currentMaxZ;
             });
        }

        // --- DRAGGING LOGIC ---
        draggableBoxes.forEach(box => {
            const handle = box.querySelector('.box-handle') || box;
            
            handle.addEventListener('mousedown', (e) => {
                if (!isDesktopView() || e.button !== 0 || e.target.closest('.resize-handle') || e.target.closest('.action-btn') || e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON' || document.body.classList.contains('blurred-content')) return;
                
                if (box.id === 'dino-box' && isDinoMaximized) return;

                activeDraggableBox = box;
                box.classList.add('dragging');
                
                currentMaxZ++;
                box.style.zIndex = currentMaxZ;
                
                const rect = box.getBoundingClientRect();
                dragOffsetX = e.clientX - rect.left;
                dragOffsetY = e.clientY - rect.top;

                document.body.style.userSelect = 'none';
            });
        });

        // --- RESIZING LOGIC ---
        function startResize(e) {
            if (!isDesktopView() || e.button !== 0 || activeDraggableBox || document.body.classList.contains('blurred-content')) return; 

            activeHandle = e.target;
            activeBox = activeHandle.closest('.draggable-box');
            
            if (activeBox.id === 'dino-box' && isDinoMaximized) return;

            isResizing = true;
            activeBox.classList.add('dragging'); 
            
            currentMaxZ++;
            activeBox.style.zIndex = currentMaxZ;

            startX = e.clientX;
            startY = e.clientY;
            
            initialW = parseFloat(getComputedStyle(activeBox).width);
            initialH = parseFloat(getComputedStyle(activeBox).height);
            initialL = parseFloat(activeBox.style.left);
            initialT = parseFloat(activeBox.style.top);
        }

        function moveResize(e) {
            if (!isResizing || !activeBox) return;

            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            const direction = activeHandle.getAttribute('data-direction');

            let newW = initialW;
            let newH = initialH;
            let newL = initialL;
            let newT = initialT;
            
            switch (direction) {
                case 'tl': 
                    newW = Math.max(MIN_SIZE, initialW - deltaX);
                    newH = Math.max(MIN_SIZE, initialH - deltaY);
                    
                    if (newW > MIN_SIZE) newL = initialL + deltaX; else newL = initialL + (initialW - MIN_SIZE);
                    if (newH > MIN_SIZE) newT = initialT + deltaY; else newT = initialT + (initialH - MIN_SIZE);
                    break;
                case 'tr': 
                    newW = Math.max(MIN_SIZE, initialW + deltaX);
                    newH = Math.max(MIN_SIZE, initialH - deltaY);
                    
                    if (newH > MIN_SIZE) newT = initialT + deltaY; else newT = initialT + (initialH - MIN_SIZE);
                    break;
                case 'bl': 
                    newW = Math.max(MIN_SIZE, initialW - deltaX);
                    newH = Math.max(MIN_SIZE, initialH + deltaY);

                    if (newW > MIN_SIZE) newL = initialL + deltaX; else newL = initialL + (initialW - MIN_SIZE);
                    break;
                case 'br': 
                    newW = Math.max(MIN_SIZE, initialW + deltaX);
                    newH = Math.max(MIN_SIZE, initialH + deltaY);
                    break;
            }

            activeBox.style.width = newW + 'px';
            activeBox.style.height = newH + 'px';
            activeBox.style.left = newL + 'px';
            activeBox.style.top = newT + 'px';

            if (activeBox.id === 'dino-box') {
                const content = activeBox.querySelector('.box-content');
                // Adjust for handle height (35px)
                if (content) content.style.height = (newH - 35) + 'px'; 
            }
        }

        function endResize() {
            if (isResizing) {
                isResizing = false;
                if (activeBox) activeBox.classList.remove('dragging');
                activeBox = null;
                activeHandle = null;
            }
        }
        
        resizeHandles.forEach(handle => {
            handle.addEventListener('mousedown', startResize);
        });

        document.addEventListener('mousemove', (e) => {
            if (isResizing) {
                moveResize(e);
            }
            else if (activeDraggableBox) {
                let newX = e.clientX - dragOffsetX;
                let newY = e.clientY - dragOffsetY;

                const boxRect = activeDraggableBox.getBoundingClientRect();
                const viewportWidth = window.innerWidth;
                const viewportHeight = window.innerHeight;

                newX = Math.max(0, Math.min(newX, viewportWidth - boxRect.width));
                newY = Math.max(0, Math.min(newY, viewportHeight - boxRect.height));

                activeDraggableBox.style.left = newX + 'px';
                activeDraggableBox.style.top = newY + 'px';
            }
        });

        document.addEventListener('mouseup', () => {
            endResize();
            if (activeDraggableBox) {
                activeDraggableBox.classList.remove('dragging');
                activeDraggableBox = null;
                document.body.style.userSelect = 'auto';
            }
        });

        document.body.oncontextmenu = (e) => { e.preventDefault(); };

        // --- Dino Game Maximize Logic ---
        if (maximizeDinoButton) {
            maximizeDinoButton.addEventListener('click', toggleDinoMaximize);
        }

        function toggleDinoMaximize() {
            if (!isDesktopView()) return; // Disable maximization on mobile

            if (isDinoMaximized) {
                dinoBox.classList.remove('maximized');
                dinoBox.style.width = dinoRestoreState.width;
                dinoBox.style.height = dinoRestoreState.height;
                dinoBox.style.left = dinoRestoreState.left;
                dinoBox.style.top = dinoRestoreState.top;
                dinoBox.style.zIndex = dinoRestoreState.zIndex;
                maximizeDinoButton.textContent = '[MAXIMIZE]';
                dinoBox.style.pointerEvents = 'auto'; 
            } else {
                dinoRestoreState = {
                    width: dinoBox.style.width,
                    height: dinoBox.style.height,
                    left: dinoBox.style.left,
                    top: dinoBox.style.top,
                    zIndex: dinoBox.style.zIndex
                };

                currentMaxZ = 999;
                dinoBox.classList.add('maximized');
                dinoBox.style.zIndex = currentMaxZ;
                maximizeDinoButton.textContent = '[RESTORE]';
                dinoBox.style.pointerEvents = 'all'; 
            }
            isDinoMaximized = !isDinoMaximized;
        }

        // --- Calculator Logic ---
        let currentDisplay = '0';
        let waitingForOperand = true;
        let pendingOperation = null;
        let firstOperand = null;
        const displayElement = document.getElementById('calc-display');

        function updateCalcDisplay() {
            const maxLen = 15;
            let displayValue = currentDisplay.length > maxLen ? currentDisplay.substring(0, maxLen) + '...' : currentDisplay;
            displayElement.textContent = displayValue;
        }

        function clearDisplay() {
            currentDisplay = '0';
            waitingForOperand = true;
            pendingOperation = null;
            firstOperand = null;
            updateCalcDisplay();
        }

        function appendNumber(num) {
            if (waitingForOperand) {
                currentDisplay = num;
                waitingForOperand = false;
            } else {
                currentDisplay = currentDisplay === '0' ? num : currentDisplay + num;
            }
            updateCalcDisplay();
        }

        function appendDecimal() {
            if (waitingForOperand) {
                currentDisplay = '0.';
                waitingForOperand = false;
            } else if (!currentDisplay.includes('.')) {
                currentDisplay += '.';
            }
            updateCalcDisplay();
        }

        function appendOperator(nextOperation) {
            const inputValue = parseFloat(currentDisplay);
            
            if (firstOperand === null) {
                firstOperand = inputValue;
            } else if (pendingOperation) {
                const result = performCalculation[pendingOperation](firstOperand, inputValue);
                currentDisplay = String(result);
                firstOperand = result;
            }

            waitingForOperand = true;
            pendingOperation = nextOperation;
            updateCalcDisplay();
        }

        function calculateResult() {
            if (firstOperand === null || pendingOperation === null) return;

            const inputValue = parseFloat(currentDisplay);
            const result = performCalculation[pendingOperation](firstOperand, inputValue);
            
            currentDisplay = String(result);
            firstOperand = null;
            pendingOperation = null;
            waitingForOperand = true;
            updateCalcDisplay();
        }

        const performCalculation = {
            '+': (first, second) => first + second,
            '-': (first, second) => first - second,
            '*': (first, second) => first * second,
            '/': (first, second) => first / second,
            '%': (first, second) => (first / 100) * second
        };
        
        // --- Time Logic ---
        function updateClocks() {
            const zones = [
                { id: 'delhi-time', zone: 'Asia/Kolkata', label: 'delhi' },
                { id: 'mumbai-time', zone: 'Asia/Kolkata', label: 'mumbai' },
                { id: 'bangalore-time', zone: 'Asia/Kolkata', label: 'bangalore' },
                { id: 'dubai-time', zone: 'Asia/Dubai', label: 'dubai' },
                { id: 'newyork-time', zone: 'America/New_York', label: 'new york' },
                { id: 'london-time', zone: 'Europe/London', label: 'london' }
            ];

            zones.forEach(city => {
                const element = document.getElementById(city.id);
                if (element) {
                    const now = new Date();
                    
                    const options = {
                        timeZone: city.zone,
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: true
                    };
                    
                    const timeString = now.toLocaleTimeString('en-US', options);
                    element.innerHTML = `${city.label}: <strong>${timeString}</strong>`;
                }
            });
        }

        // --- Timer Logic ---
        let timerInterval = null;
        let timeRemaining = 0;
        let isTimerRunning = false;
        const timerDisplay = document.getElementById('timer-display');
        const minutesInput = document.getElementById('minutes-input');
        const secondsInput = document.getElementById('seconds-input');
        const timerStatus = document.getElementById('timer-status');

        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            const pad = (num) => String(num).padStart(2, '0');
            return `${pad(minutes)}:${pad(seconds)}`;
        }

        function startTimer() {
            if (isTimerRunning) return;

            if (timeRemaining <= 0) {
                const minutes = parseInt(minutesInput.value) || 0;
                const seconds = parseInt(secondsInput.value) || 0;
                timeRemaining = minutes * 60 + seconds;
            }

            if (timeRemaining <= 0) {
                timerStatus.textContent = 'please set a time > 0.';
                return;
            }

            isTimerRunning = true;
            timerStatus.textContent = 'timer is running...';
            
            timerInterval = setInterval(() => {
                if (timeRemaining > 0) {
                    timeRemaining--;
                    timerDisplay.textContent = formatTime(timeRemaining);
                } else {
                    clearInterval(timerInterval);
                    isTimerRunning = false;
                    timerStatus.textContent = 'time\'s up!';
                    timerDisplay.textContent = '00:00';
                    // Tone.js implementation for sound alert is omitted here as per core guidelines but would go here.
                }
            }, 1000);
        }

        function pauseTimer() {
            if (!isTimerRunning) return;
            clearInterval(timerInterval);
            isTimerRunning = false;
            timerStatus.textContent = 'timer paused.';
        }

        function resetTimer() {
            clearInterval(timerInterval);
            isTimerRunning = false;
            timeRemaining = 0;
            timerDisplay.textContent = '00:00';
            minutesInput.value = '1';
            secondsInput.value = '0';
            timerStatus.textContent = 'set duration and click start.';
        }

        // --- DOM Ready / Initial Setup ---
        document.addEventListener('DOMContentLoaded', () => {
            const passwordInput = document.getElementById('password-input');
            
            // 1. Start the 30-second automatic unlock timer
            unlockTimeoutId = setTimeout(autoUnlock, UNLOCK_TIMEOUT_MS);
            
            // 2. Setup Enter key listener
            if (passwordInput) {
                passwordInput.focus();
                passwordInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        checkPassword();
                    }
                });
            }
        });

    </script>
</body>
</html>
